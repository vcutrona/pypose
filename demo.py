import numpy as np

from pypose.pose import Pose

if __name__ == '__main__':
    np.set_printoptions(precision=20)

    p_ref = Pose([
        0.3648405853172375, 0.36002464232428383, 0.0007253576361402336,
        -1.6785132281085973, -2.6546939621882597, 0.03902168102548334])
    p1 = Pose([0.34148076142347306, 0.1560891428915708, 0.017478303884116447,
               -1.7290282137450195, -2.604739701698602, 0.10419471768610328])

    p_feature = Pose([0.4412747227009374, 0.35843044298037274, 0.0016570165467657827,
                      1.6306309836645287, 2.6835518016778734, -0.011374302523718271])

    ppref_gt = Pose(pose=[-0.17441359469380963, -0.10885108896723711, -0.012094781203379165,
                          0.04282538558297698, -0.010471119427049399, 0.044202537564109065])

    p_final_gt = Pose([0.42504345549209355, 0.1535703181053688, 0.015215059057407448,
                       -1.6836450571513213, -2.6373704714545925, 0.07705645607312081])

    pbf = p_ref.invert()
    ppref = pbf.trans(p1)

    print(ppref - ppref_gt)
    assert ppref == ppref_gt

    p_final = p_feature.trans(ppref)
    print(p_final - p_final_gt)
    assert p_final == p_final_gt
